"0","simu_unif <- function(multi, n, m, xmax, sigmaep = 1){"
"0",""
"0","    X <- runif(n*multi,xmax)"
"0","    Y <- mx(X) + rnorm(n, sd = sigmaep)"
"0",""
"0","  return(data.frame(X, Y))"
"0","}"
"0",""
"0","simu_norm <- function(multi, n, m, meanx, sigmax, sigmaep = 1){"
"0",""
"0","    X <- rnorm(n*multi,mean = meanx,sd = sigmax)"
"0","    Y <- mx(X) + rnorm(n*multi, sd = sigmaep)"
"0",""
"0","  return(data.frame(X, Y))"
"0","}"
"0",""
"0","nw_simu <- function(data, testd, n, h, k){"
"0","  "
"0","    esti_nw <- testd$Y"
"0","    esti <- data.frame()"
"0","    X <- data$X"
"0","    Y <- data$Y"
"0","    real <- testd$Y"
"0","    test <- testd$X"
"0","    "
"0","    for(j in 1:length(test)){"
"0","    #set.seed(i) # random, may exist better solutions"
"0","        esti_nw[j] <- mhat(n,h,test[j],X,Y,k)"
"0","    }"
"0","    "
"0","    MSE_NW <- mean((real - esti_nw)^2)"
"0","    #browser()"
"0",""
"0","    esti <- rbind(esti,data.frame(X = test,esti_nw))"
"0",""
"0","  return(list(MSE = MSE_NW, esti = esti))"
"0","  "
"0","}"
"0",""
"0","#Self-Supervised"
"0","ss_simu <- function(data, data_un, testd, n, h, m, g, k){"
"0","  esti <- data.frame()"
"0","    esti_ss <- testd$Y"
"0",""
"0","    X <- data$X"
"0","    Y <- data$Y"
"0","    Xu <- data_un$X"
"0","    "
"0","    test <- testd$X"
"0","    real <- testd$Y"
"0","    "
"0","    for(j in 1:length(test)){"
"0","    #set.seed(i) # random, may exist better solutions"
"0","        esti_ss[j] <- rhat(n,h,test[j],X,Y,k,m,g,Xu)"
"0","    }"
"0","    "
"0","    MSE_SS <- mean((real - esti_ss)^2)"
"0","    #browser()"
"0",""
"0","    esti <- rbind(esti,data.frame(X = test,esti_ss))"
"0","  "
"0","  "
"0","  return(list(MSE = MSE_SS, esti = esti))"
"0","  "
"0","}"
"0",""
"0","hy_simu <- function(testd, lambda, esti_nw, esti_ss){"
"0","  "
"0","  esti <- data.frame()"
"0","  "
"0","  real <- testd$Y"
"0","  "
"0","  esti_hy <- lambda * esti_nw + (1-lambda) * esti_ss"
"0","  "
"0","  esti <- rbind(esti,data.frame(X = testd$X ,esti_hy))"
"0","  "
"0","  MSE_HY <- mean((real - esti_hy)^2)"
"0",""
"0","  return(list(MSE = MSE_HY, esti = esti))"
"0","}"
