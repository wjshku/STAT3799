"0","nw_cv <- function(hlist = seq(0.1,4,0.1),train_label){"
"0","  mse_min <- 10000"
"0","  h_opt <- 0.1"
"0","  for(h in hlist){"
"0","    mse <- 0"
"0","    for(exp in 1:nrow(train_label)){"
"0","        "
"0","        test <- train_label[exp,]"
"0","        "
"0","        train_label_loo <- train_label[-exp,]"
"0","        "
"0","        esti <- mhat(n = para$n,h = h,x = test$X,X = train_label_loo$X,Y = train_label_loo$Y,k)"
"0","        "
"0","        mse <- mse + (esti - test$Y)^2"
"0","    }"
"0","    #print(mse)"
"0","    if(mse < mse_min){"
"0","      mse_min <- mse"
"0","      h_opt <- h"
"0","    }"
"0","  }"
"0","  return(h_opt)"
"0","}"
"0",""
"0","nw_1_cv <- function(hlist = seq(0.1,1.4,0.1),train_label){"
"0","  mse_min <- 10000"
"0","  h_opt <- 0.1"
"0","  for(h in hlist){"
"0","    mse <- 0"
"0","    for(exp in 2:nrow(train_label)){"
"0","        "
"0","        test_x <- (train_label[exp-1,1]+train_label[exp,1])/2"
"0","        test_y <- (train_label[exp-1,2]-train_label[exp,2])/(train_label[exp-1,1]-train_label[exp,1])"
"0","        "
"0","        train_label_loo <- train_label[-((exp-1):exp),]"
"0","        "
"0","        esti <- mhat_1(n = para$n,h = h,x = test_x,X = train_label_loo$X,Y = train_label_loo$Y,k,k_1)"
"0","        "
"0","        mse <- mse + (esti - test_y)^2"
"0","        #print(test_y)"
"0","    }"
"0","    #print(mse)"
"0","    if(mse < mse_min){"
"0","      mse_min <- mse"
"0","      h_opt <- h"
"0","    }"
"0","  }"
"0","  return(h_opt)"
"0","}"
