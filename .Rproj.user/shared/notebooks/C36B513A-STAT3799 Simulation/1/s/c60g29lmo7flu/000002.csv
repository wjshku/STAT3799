"0","loocv <- function(para,hlist, glist, train_label, train_un){"
"0",""
"0","  result_ci <- data.frame()"
"0",""
"0","  for(i in 1:length(hlist)){"
"0","  for(j in 1:length(glist)){"
"0","      coverage <- data.frame()"
"0","      para$h <- hlist[i]"
"0","      para$g <- glist[j]"
"0","    for(exp in 1:nrow(train_label)){"
"0","      "
"0","      test <- train_label[exp,]"
"0","      "
"0","      train_label_loo <- train_label[-exp,]"
"0","      "
"0","      sigmaep_esti <- esti_sigmaep(para$n,para$h,train_label)"
"0","      "
"0","      coverage <- rbind(coverage,CI(0.95,mx_deriv1,para,train_label,train_un,test,px,qx,sigmaep_esti,rk$value,sigmak$value))"
"0","    }"
"0","    coverage <- cbind(coverage, train_label)"
"0","    cover <- (coverage$lower <= train_label$Y)*(coverage$upper >= train_label$Y)"
"0","    "
"0","    cover_prop <- mean(cover,na.rm = T)"
"0","    "
"0","    result_ci <- rbind(result_ci, data.frame(h = para$h, g = para$g, cover_prop, msd = sqrt(mean(coverage$sd^2))))"
"0","  }"
"0","  }"
"0","  result_ci$error <- abs(result_ci$cover_prop - 0.95)"
"0","  "
"0","  best <- result_ci[match(min(result_ci$error),result_ci$error),]"
"0","  "
"0","  return(best)"
"0","}"
"0",""
